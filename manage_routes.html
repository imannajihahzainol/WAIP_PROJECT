<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTB | Manage Routes</title>

  <!-- Bootsrap Icon -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <!-- Bootsrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Open+Sans:wght@400;500&display=swap" rel="stylesheet">

  <!-- External CSS -->
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body class="bg-light">

    <div class="d-flex" id="wrapper">
        
        <div class="admin-sidebar" id="sidebar-wrapper">
            <div class="sidebar-heading border-bottom p-3 text-center" style="background-color: #ebd9ff;">
                <img src="assets/img/btb_logo.png" alt="BTB Logo" style="height: 40px; filter: drop-shadow(0 0 1px #fff);"> 
            </div>
            
            <div class="list-group list-group-flush admin-sidebar-nav">
                <a class="list-group-item list-group-item-action p-3" href="admin.html">
                    <i class="bi bi-speedometer2 me-2"></i>Dashboard
                </a>
                <a class="list-group-item list-group-item-action p-3 active" href="manage_routes.html">
                    <i class="bi bi-geo-alt me-2"></i>Manage Routes
                </a>
            </div>
        </div>
        
        <div id="page-content-wrapper" class="flex-grow-1">

            <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom shadow-sm">
                <div class="container-fluid">
                    <h5 class="mb-0 fw-bold text-dark">Route Management</h5>
                    
                    <div class="dropdown">
                        <a href="#" class="d-flex align-items-center text-dark text-decoration-none dropdown-toggle" id="adminMenu" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-person-circle fs-4 me-1"></i> Admin User
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="adminMenu">
                            <li><a class="dropdown-item" href="#">Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="admin_login.html">Log Out</a></li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="container-fluid p-4 admin-dashboard">
                <h1 class="mt-4 mb-4 fw-bold">Create New Route</h1>

                <div class="card shadow-sm mb-5 p-4 dashboard-card">
                    <form action="#" method="POST">
                        <h4 class="mb-3" style="color: #5c359d;">Route Details (ROUTES Table)</h4>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="routeName" class="form-label fw-semibold">Route Name (e.g., KL to JB)</label>
                                <input type="text" class="form-control" id="routeName" name="routeName" required>
                            </div>
                            <div class="col-md-6">
                                <label for="routeId" class="form-label fw-semibold">Route ID</label>
                                <input type="text" class="form-control" id="routeId" name="routeId" placeholder="Auto-generated or Manual ID" disabled>
                            </div>
                            <div class="col-12">
                                <label for="routeDesc" class="form-label fw-semibold">Route Description</label>
                                <textarea class="form-control" id="routeDesc" name="routeDesc" rows="2" required></textarea>
                            </div>
                        </div>

                        <h4 class="mb-3 mt-4" style="color: #5c359d;">Schedule Details (SCHEDULES Table)</h4>

                        <div id="scheduleSlots">
                            <div class="row g-3 schedule-slot border-bottom pb-3 mb-3">
                                <div class="col-md-3">
                                    <label for="departTime1" class="form-label small fw-semibold">Departure Time</label>
                                    <input type="time" class="form-control" id="departTime1" name="departTime[]" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="price1" class="form-label small fw-semibold">Price (RM)</label>
                                    <input type="number" class="form-control" id="price1" name="price[]" step="0.01" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="maxSeats1" class="form-label small fw-semibold">Max Seats</label>
                                    <input type="number" class="form-control" id="maxSeats1" name="maxSeats[]" required value="40">
                                </div>
                                <div class="col-md-3 d-flex align-items-end">
                                    <button type="button" class="btn btn-sm btn-outline-danger w-100" onclick="removeSlot(this)"><i class="bi bi-trash"></i> Remove</button>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" id="addSlotBtn" class="btn btn-outline-secondary btn-sm mb-4">
                            <i class="bi bi-clock-history me-1"></i> Add Another Time Slot
                        </button>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-warning text-white fw-bold p-2">
                                <i class="bi bi-save me-2"></i> Save Route & Schedules
                            </button>
                        </div>
                    </form>
                </div>
                
                <h1 class="mt-5 mb-4 fw-bold">Existing Routes</h1>

                <div class="card shadow-sm mb-4 dashboard-card">
                    <div class="card-body">
                        <table class="table table-striped table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>Route ID</th>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Schedules</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="existingRoutesTable">
                                <tr>
                                    <td>R-001</td>
                                    <td>Kuala Lumpur to Johor Bahru</td>
                                    <td>Connecting major cities.</td>
                                    <td>3 Slots</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary me-2">Edit</button>
                                        <button class="btn btn-sm btn-outline-danger">Delete</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>R-005</td>
                                    <td>Penang to Kuala Lumpur</td>
                                    <td>Daily express service.</td>
                                    <td>2 Slots</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary me-2">Edit</button>
                                        <button class="btn btn-sm btn-outline-danger">Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
            </div>
        </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let slotCount = 1;
            const scheduleSlots = document.getElementById('scheduleSlots');
            const addSlotBtn = document.getElementById('addSlotBtn');

            function addSlot() {
                slotCount++;
                const newSlot = document.createElement('div');
                newSlot.className = 'row g-3 schedule-slot border-bottom pb-3 mb-3';
                newSlot.innerHTML = `
                    <div class="col-md-3">
                        <label for="departTime${slotCount}" class="form-label small fw-semibold">Departure Time</label>
                        <input type="time" class="form-control" id="departTime${slotCount}" name="departTime[]" required>
                    </div>
                    <div class="col-md-3">
                        <label for="price${slotCount}" class="form-label small fw-semibold">Price (RM)</label>
                        <input type="number" class="form-control" id="price${slotCount}" name="price[]" step="0.01" required>
                    </div>
                    <div class="col-md-3">
                        <label for="maxSeats${slotCount}" class="form-label small fw-semibold">Max Seats</label>
                        <input type="number" class="form-control" id="maxSeats${slotCount}" name="maxSeats[]" required value="40">
                    </div>
                    <div class="col-md-3 d-flex align-items-end">
                        <button type="button" class="btn btn-sm btn-outline-danger w-100" onclick="removeSlot(this)"><i class="bi bi-trash"></i> Remove</button>
                    </div>
                `;
                scheduleSlots.appendChild(newSlot);
            }

            // Function must be global to be accessed via the inline onclick attribute
            window.removeSlot = function(button) {
                if (scheduleSlots.children.length > 1) {
                    button.closest('.schedule-slot').remove();
                } else {
                    alert("You must have at least one time slot.");
                }
            };
            
            addSlotBtn.addEventListener('click', addSlot);
        });
    </script>
</body>
</html>